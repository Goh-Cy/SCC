(()=>{const e=document.getElementById("taskList"),t=document.getElementById("dueDate"),n=(document.getElementById("priority"),document.getElementById("submitBtn")),o=document.getElementById("editTask"),l=document.getElementById("heading-tasks"),i=document.getElementById("searchBar"),d=document.getElementById("modeToggle"),s=document.querySelectorAll(".form-check-input");let c=null;const a={High:"task-priority-High",Medium:"task-priority-Medium",Low:"task-priority-Low",Completed:"task-completed"};function r(){0===e.children.length&&(l.classList.toggle("hidden"),i.classList.toggle("hidden"),document.querySelector(".clear_btn").style.display="none",document.querySelector(".dropdown").style.display="none")}function m(e){e.preventDefault(),o.style.display="inline",n.style.display="none";const t=e.target.parentElement.childNodes[1].textContent.trim();console.log(e.target.parentElement.childNodes);const l=e.target.parentElement.childNodes[4].textContent.trim().replace("Description:","");document.getElementById("item").value=t,document.getElementById("description").value=l,document.getElementById("maintitle").innerText="Edit your tasks below :",c=e.target,document.documentElement.scrollTop=0,document.getElementById("item").focus()}function u(e){if(e){const t=e.querySelector("#task-dueDate"),n=e.querySelector("#task-priority"),o=t?t.textContent.split(":")[1].trim():null,l=n?n.textContent.trim():null;console.log(`Task Details - Due Date: ${o}, Priority: ${l}`)}}function p(e){const t=e.target.parentElement,n=t.dataset.originalClassList,o=t.querySelector(".edit");o&&(o.style.display="none"===o.style.display?"block":"none"),n?(t.className=n,t.removeAttribute("data-original-class-list")):(t.dataset.originalClassList=t.className,t.classList.toggle("task-completed"))}function y(e){document.getElementById("lblsuccess").innerHTML=e,document.getElementById("lblsuccess").style.display="block",setTimeout((function(){document.getElementById("lblsuccess").style.display="none"}),3e3)}function g(e){document.getElementById("lblerror").innerHTML=e,document.getElementById("lblerror").style.display="block",setTimeout((function(){document.getElementById("lblerror").style.display="none"}),3e3)}function f(){var e;!function(e){localStorage.setItem("tasks",JSON.stringify(e))}((e=document.querySelectorAll(".list-group-item"),Array.from(e).map((e=>{const t=e.childNodes[1].textContent,n=e.classList.contains("completed"),o=e.querySelector("#created-at").textContent,l=e.querySelector("#description-at")?e.querySelector("#description-at").textContent:"";return function(e,t,n,o,l,i){return{text:e,completed:t,createdAt:n,dueDate:o,priority:l,description:i}}(t,n,o,e.querySelector("#task-dueDate").textContent,e.querySelector("#task-priority").textContent,l)}))))}o.addEventListener("click",(e=>{!function(e){e.preventDefault();const t=document.getElementById("item"),l=document.getElementById("dueDate"),i=document.getElementById("description"),d=t.value,s=i.value,r=new Date(l.value),m=(new Date).toISOString().split("T")[0],u=document.getElementById("priority").value;if(!d.trim())return g("Task not entered"),!1;if(!d)return g("Title must not be empty!!!."),!1;if(r<new Date(m))return g("Due date has already passed !!!"),!1;if(!u)return g("Please select priority"),!1;const p=c.parentElement;p.childNodes[1].textContent=d,p.childNodes[4].textContent=s.trim()?"Description: "+s:"",p.childNodes[7].textContent=u,r>=new Date(m)&&(p.childNodes[6].textContent=`Due Date:${l.value}`);const h=u.charAt(0).toUpperCase()+u.slice(1).toLowerCase();p.className=`list-group-item card shadow mb-4 bg-transparent ${a[h]}`,y("Task edited successfully !!!"),c=null,t.value="",i.value="",l.value="",document.getElementById("maintitle").innerText="Add your tasks below :",o.style.display="none",n.style.display="inline",f()}(e)})),n.addEventListener("click",(t=>{!function(t){t.preventDefault(),r();const n=document.getElementById("item").value,o=document.getElementById("description").value;let d=document.getElementById("dueDate").value;const s=document.getElementById("priority").value,c=new Date,y=new Date(d);if(function(e){var t=document.getElementById("taskList").querySelectorAll("li"),n=[];return t.forEach((function(e){var t=e.textContent.trim();n.push(t)})),TitleArray=n.map((function(e){var t=e.match(/^(.*?)Description/);return t?t[1]:null})),TitleArray.includes(e)}(n))return function(){const e=document.getElementById("duplicate-task");delalert_title=document.getElementById("duplicate-msg"),delalert_title.innerHTML="&#9888; This task is already present",delalert_title.className="alert alert-danger",delalert_title.role="alert";const t=document.getElementById("duplicate-ok"),n=document.getElementById("duplicate-cancel"),o=()=>{e.style.display="none",t.removeEventListener("click",o),n.removeEventListener("click",l)},l=()=>{e.style.display="none",t.removeEventListener("click",o),n.removeEventListener("click",l)};t.addEventListener("click",o),n.addEventListener("click",l),e.style.display="flex"}(),!1;let h=""!==o.trim();if(!n)return g("Task Title should be filled!!!"),l.classList.add("hidden"),i.classList.add("hidden"),!1;if(!d)return g("Please specify a due date !!!"),!1;if(y<c)return g("Due date has already passed !!!"),!1;if(l.classList.remove("hidden"),i.classList.remove("hidden"),""===n.trim())return!1;document.getElementById("item").value="",document.querySelector(".clear_btn").style.display="inline",document.querySelector(".dropdown").style.display="inline";(function(t,n,o,l,i,d){const s=document.createElement("li");s.className=`list-group-item card shadow mb-4 bg-transparent ${a[l]}`;const c=document.createElement("input");c.type="checkbox",c.className="form-check-input task-completed",c.addEventListener("change",p);const r=document.createElement("button");r.type="button",r.className="btn btn-outline-danger float-right delete",r.innerHTML='<ion-icon name="trash-outline" style="font-size: 20px"></ion-icon>',r.style.paddingTop="10px",r.style.PaddingRight="10px";const y=document.createElement("button");y.className="btn btn-outline-secondary btn-sm float-right edit",y.innerHTML='<ion-icon name="create-outline" style="font-size: 20px"></ion-icon>',y.style.marginRight="8px",y.style.paddingTop="10px",y.style.PaddingRight="10px",y.addEventListener("click",(function(e){m(e)}));const g=document.createElement("p");!0===d&&(g.className="text-muted",g.id="description-at",g.style.fontSize="15px",g.style.margin="0 19px",g.appendChild(document.createTextNode("Description: "+i)));const f=document.createElement("p");f.className="text-muted",f.id="created-at",f.style.fontSize="15px",f.style.margin="0 19px",f.appendChild(document.createTextNode("Created: "+n));const h=document.createElement("p");h.className="text-muted",h.id="task-dueDate",h.style.fontSize="15px",h.style.margin="0 19px",h.appendChild(document.createTextNode("Due Date: "+o));const E=document.createElement("p");E.className="text-muted",E.id="task-priority",E.style.fontSize="15px",E.style.margin="0 19px",E.appendChild(document.createTextNode(l)),s.appendChild(c),s.appendChild(document.createTextNode(t)),s.appendChild(r),s.appendChild(y),s.appendChild(g),s.appendChild(f),s.appendChild(h),s.appendChild(E),e.appendChild(s),u(s)})(n,(new Date).toLocaleString(),d,s,o,h),f(),document.getElementById("dueDate").value="",document.getElementById("description").value="",document.getElementById("priority").value=""}(t)})),e.addEventListener("click",(function(e){if(e.target.classList.contains("delete")){e.preventDefault();const t=e.target.parentElement,n=document.getElementById("custom-confirm");delalert_title=document.getElementById("confirm-msg"),delalert_title.innerHTML="&#9888; Are you sure you want to delete this task?",delalert_title.className="alert alert-danger",delalert_title.role="alert";const o=document.getElementById("confirm-yes"),l=document.getElementById("confirm-no"),i=document.getElementById("confirm-cancel"),d=()=>{n.style.display="none",t.parentElement.removeChild(t),r(),y("Task deleted successfully !!!"),f(),o.removeEventListener("click",d),l.removeEventListener("click",s),i.removeEventListener("click",c)},s=()=>{n.style.display="none",o.removeEventListener("click",d),l.removeEventListener("click",s),i.removeEventListener("click",c)},c=()=>{n.style.display="none",o.removeEventListener("click",d),l.removeEventListener("click",s),i.removeEventListener("click",c)};o.addEventListener("click",d),l.addEventListener("click",s),i.addEventListener("click",c),n.style.display="flex"}f()})),d.addEventListener("click",(function(){document.body.classList.toggle("dark-mode"),document.body.classList.toggle("light-mode"),!0===d.checked?localStorage.setItem("dark-mode","enabled"):localStorage.setItem("dark-mode",null)})),s.forEach((e=>{e.addEventListener("change",p)})),flatpickr(t,{enableTime:!1,dateFormat:"Y-m-d"}),document.addEventListener("DOMContentLoaded",(function(){const e=new(window.SpeechRecognition||window.webkitSpeechRecognition);e.lang="en-US",e.interimResults=!1;let t=!1;const n=document.getElementById("voice-command-button");function o(e){const t=document.querySelectorAll(".list-group-item");for(const n of t)if(n.childNodes[1].textContent.trim().toLowerCase()===e.toLowerCase())return n;return null}n.addEventListener("click",(function(){t?(e.stop(),t=!1,n.innerHTML='<i class="fas fa-microphone"></i>'):(e.start(),t=!0,n.innerHTML='<i class="fas fa-microphone-slash"></i>')})),e.onresult=function(e){!function(e){console.log("Recognized Command:",e);const t=e.split(" ");if(e.length>=4)if(e.toLowerCase().includes("add")){const e=t.indexOf("add")+1,n=t.indexOf("due"),o=t.indexOf("date"),l=t.indexOf("priority");e<n&&n<o&&o<l&&function(e,t,n){const o=document.getElementById("taskList"),l=o.querySelectorAll("li");l.forEach((e=>console.log(e.textContent.trim().toLowerCase())));if(Array.from(l).some((t=>t.textContent.trim().toLowerCase()===e.trim().toLowerCase())))return void g("Task already exists !!!");const i=document.createElement("li"),d=n.charAt(0).toUpperCase()+n.slice(1).toLowerCase();console.log("Priority:",n),console.log("Priority Class:",a[d]),i.className=`list-group-item card shadow mb-4 bg-transparent ${a[d]}`;const s=document.createElement("input");s.type="checkbox",s.className="form-check-input task-completed",s.addEventListener("change",p);const c=document.createElement("button");c.type="button",c.className="btn btn-outline-danger float-right delete",c.innerHTML='<ion-icon name="trash-outline" style="font-size: 20px"></ion-icon>';const r=document.createElement("button");r.className="btn btn-outline-success btn-sm float-right edit",r.innerHTML='<ion-icon name="create-outline" style="font-size: 20px"></ion-icon>',r.style.marginRight="8px",r.addEventListener("click",m);const y=document.createElement("p");y.className="text-muted",y.id="created-at",y.style.fontSize="15px",y.style.margin="0 19px",y.appendChild(document.createTextNode("Created:"+(new Date).toLocaleString()));const h=document.createElement("p");h.className="text-muted",h.id="task-dueDate",h.style.fontSize="15px",h.style.margin="0 19px",h.appendChild(document.createTextNode("Due Date:"+t));const E=document.createElement("p");E.className="text-muted",E.id="task-priority",E.style.fontSize="15px",E.style.margin="0 19px",E.appendChild(document.createTextNode(d)),i.appendChild(s),i.appendChild(document.createTextNode(e)),i.appendChild(c),i.appendChild(r),i.appendChild(y),i.appendChild(h),i.appendChild(E),o.appendChild(i),f(),u(i)}(t.slice(e,n).join(" "),t.slice(o+1,l).join(" "),t[l+1])}else if(e.toLowerCase().includes("edit")&&e.toLowerCase().includes("task")){const e=t.indexOf("edit"),l=t.indexOf("task"),i=t.indexOf("to"),d=t.indexOf("due"),s=t.indexOf("priority");if(-1!==e&&-1!==l&&-1!==i&&-1!==d&&-1!==s&&i>l&&d>i&&s>d&&s<t.length-1){!function(e,t,n,l){const i=o(e);if(i){const o=i.querySelector("#task-dueDate"),d=i.querySelector("#task-priority"),s=i.querySelector("#description-at"),c=i.childNodes[1];c.textContent=c.textContent.replace(e,t),o&&(o.textContent=`Due Date: ${n}`,o.id="task-dueDate"),d&&(d.textContent=l,d.id="task-priority"),s&&(s.textContent=void 0,s.id="task-description"),u(i),f(),y(`Task "${e}" edited successfully.`)}else g(`Task "${e}" not found.`)}(t.slice(l+1,i).join(" "),t.slice(i+1,d).join(" "),t.slice(d+2,d+4),(n=t[s+1],n.charAt(0).toUpperCase()+n.slice(1)))}}else if(e.toLowerCase().includes("delete")){const e=t.indexOf("task")+1;!function(e){const t=o(e);t?(t.remove(),f(),y(`Task "${e}" deleted successfully.`)):g(`Task "${e}" not found.`)}(t.slice(e).join(" "))}else g("Invalid voice command format.");var n}(e.results[0][0].transcript)},e.onend=function(){t=!1,n.innerHTML='<i class="fas fa-microphone"></i>'}})),window.onclick=function(e){if(!e.target.matches(".dropbtn"))for(var t=document.getElementsByClassName("dropdown-content"),n=0;n<t.length;n++){var o=t[n];o.classList.contains("show")&&o.classList.remove("show")}},document.addEventListener("DOMContentLoaded",(function(){setTimeout((function(){document.querySelector(".preloader").style.display="none"}),2e3)})),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("todo-header");!function t(n,o){e.textContent=n.slice(0,o),o<n.length&&setTimeout((function(){t(n,o+1)}),50)}("To-Do List Application",0)})),0===localStorage.length?window.matchMedia("(prefers-color-scheme: dark)").matches?(document.body.classList.toggle("dark-mode"),localStorage.setItem("dark-mode","enabled"),d.checked=!0):(document.body.classList.toggle("light-mode"),localStorage.setItem("dark-mode",null)):"enabled"===localStorage.getItem("dark-mode")?(document.body.classList.toggle("dark-mode"),d.checked=!0):document.body.classList.toggle("light-mode")})();